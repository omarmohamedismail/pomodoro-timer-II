let studyTime = 50 * 60;
let breakTime = 10 * 60;
let timeLeft = studyTime;
let isStudy = true;
let timer = null;

const timeEl = document.getElementById("time");
const modeEl = document.getElementById("mode");
const player = document.getElementById("spotifyPlayer");

function update() {
  const m = Math.floor(timeLeft / 60);
  const s = timeLeft % 60;
  timeEl.textContent = `${m}:${s < 10 ? "0" : ""}${s}`;
}

function start() {
  if (timer) return;
  timer = setInterval(() => {
    timeLeft--;
    update();
    if (timeLeft <= 0) {
      isStudy = !isStudy;
      timeLeft = isStudy ? studyTime : breakTime;
      modeEl.textContent = isStudy ? "Study Time" : "Break Time";
    }
  }, 1000);
}

function pause() {
  clearInterval(timer);
  timer = null;
}

function reset() {
  pause();
  isStudy = true;
  timeLeft = studyTime;
  modeEl.textContent = "Study Time";
  update();
}

function loadSpotify() {
  const link = document.getElementById("spotifyLink").value.trim();
  if (!link) return;

  const embedLink = link.replace(
    "https://open.spotify.com/",
    "https://open.spotify.com/embed/"
  );

  player.src = embedLink;
}

update();
